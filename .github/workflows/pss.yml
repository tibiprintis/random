name: Reveal FTP host & path (mirror)

on:
  workflow_dispatch: {}

permissions:
  contents: read

env:
  FTP_HOST: ${{ secrets.FTP_SERVER }}
  FTP_PATH: ${{ secrets.FTP_PATH }}

jobs:
  reveal:
    runs-on: ubuntu-24.04
    steps:
      - name: Mirror print
        run: |
          mirror() {
            printf "%s" "$1" | rev
          }

          H_RAW="${FTP_HOST:-}"
          P_RAW="${FTP_PATH:-}"

          if [ -z "$H_RAW" ]; then
            echo "❌ Secret FTP_SERVER nu este setat."
            exit 1
          fi

          echo "SERVER (mirror): $(mirror "$H_RAW")"
          echo "SERVER length: ${#H_RAW}"

          if [ -n "$P_RAW" ]; then
            echo "SERVER_DIR (mirror): $(mirror "$P_RAW")"
            echo "SERVER_DIR length: ${#P_RAW}"
          else
            echo "SERVER_DIR nu este setat."
          fi

          {
            echo "## Rezumat"
            echo ""
            echo "- SERVER (mirror): \`$(mirror "$H_RAW")\`"
            [ -n "$P_RAW" ] && echo "- SERVER_DIR (mirror): \`$(mirror "$P_RAW")\`"
            echo ""
            echo "👉 Inversează local stringul (mirror) pentru a afla valoarea originală:"
            echo "- Linux/macOS: \`echo -n 'VALOARE_MIRROR' | rev\`"
            echo "- PowerShell:  \`('VALOARE_MIRROR'.ToCharArray() | ForEach-Object {[char]$_})[-1..0] -join ''\`"
          } >> "$GITHUB_STEP_SUMMARY"
